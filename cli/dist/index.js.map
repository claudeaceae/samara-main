{"version":3,"sources":["../src/index.ts","../src/steps/welcome.ts","../src/utils/prerequisites.ts","../src/utils/shell.ts","../src/steps/identity.ts","../src/steps/collaborator.ts","../src/steps/integrations.ts","../src/steps/birth.ts","../src/steps/app.ts","../src/steps/permissions.ts","../src/steps/launchd.ts","../src/steps/credentials.ts","../src/steps/launch.ts","../src/steps/summary.ts"],"sourcesContent":["#!/usr/bin/env node\nimport * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync } from 'fs';\nimport { join, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport {\n  createContext,\n  loadSavedState,\n  restoreFromState,\n  saveState,\n  shouldSkipStep,\n  getResumeStep,\n} from './context.js';\nimport type { StepName, WizardContext } from './types.js';\n\n// Step imports\nimport { welcome } from './steps/welcome.js';\nimport { identity } from './steps/identity.js';\nimport { collaborator } from './steps/collaborator.js';\nimport { integrations } from './steps/integrations.js';\nimport { birth } from './steps/birth.js';\nimport { app } from './steps/app.js';\nimport { permissions } from './steps/permissions.js';\nimport { launchd } from './steps/launchd.js';\nimport { credentials } from './steps/credentials.js';\nimport { launch } from './steps/launch.js';\nimport { summary } from './steps/summary.js';\n\n// Step definitions\ninterface Step {\n  name: StepName;\n  fn: (ctx: WizardContext) => Promise<void>;\n}\n\nconst STEPS: Step[] = [\n  { name: 'welcome', fn: welcome },\n  { name: 'identity', fn: identity },\n  { name: 'collaborator', fn: collaborator },\n  { name: 'integrations', fn: integrations },\n  { name: 'birth', fn: birth },\n  { name: 'app', fn: app },\n  { name: 'permissions', fn: permissions },\n  { name: 'launchd', fn: launchd },\n  { name: 'credentials', fn: credentials },\n  { name: 'launch', fn: launch },\n  { name: 'summary', fn: summary },\n];\n\n/**\n * Find the repo path by looking for birth.sh\n */\nfunction findRepoPath(): string {\n  // Try current directory\n  if (existsSync(join(process.cwd(), 'birth.sh'))) {\n    return process.cwd();\n  }\n\n  // Try parent directory\n  const parentDir = dirname(process.cwd());\n  if (existsSync(join(parentDir, 'birth.sh'))) {\n    return parentDir;\n  }\n\n  // Try common locations\n  const commonPaths = [\n    join(process.env.HOME || '', 'Developer/samara-main'),\n    join(process.env.HOME || '', 'Developer/samara'),\n    join(process.env.HOME || '', 'samara-main'),\n    join(process.env.HOME || '', 'samara'),\n  ];\n\n  for (const path of commonPaths) {\n    if (existsSync(join(path, 'birth.sh'))) {\n      return path;\n    }\n  }\n\n  // Default to current directory\n  return process.cwd();\n}\n\nasync function main(): Promise<void> {\n  console.clear();\n\n  p.intro(color.bgCyan(color.black(' create-samara ')));\n\n  // Check for saved state\n  const savedState = loadSavedState();\n  let ctx: WizardContext;\n\n  if (savedState) {\n    const resumeStep = getResumeStep(savedState);\n    const shouldResume = await p.confirm({\n      message: `Resume setup from \"${resumeStep}\" step?`,\n      initialValue: true,\n    });\n\n    if (p.isCancel(shouldResume)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (shouldResume) {\n      ctx = restoreFromState(savedState);\n      p.log.info(`Resuming from ${color.cyan(resumeStep)} step...`);\n    } else {\n      ctx = createContext();\n      p.log.info('Starting fresh setup...');\n    }\n  } else {\n    ctx = createContext();\n  }\n\n  // Find repo path\n  ctx.repoPath = findRepoPath();\n\n  if (!existsSync(join(ctx.repoPath, 'birth.sh'))) {\n    p.log.warn(`Samara repository not found at ${ctx.repoPath}`);\n\n    const repoPath = await p.text({\n      message: 'Enter the path to your samara-main repository',\n      placeholder: '~/Developer/samara-main',\n      validate: (value) => {\n        if (!value || value.length === 0) return 'Path is required';\n        const expandedPath = value.replace('~', process.env.HOME || '');\n        if (!existsSync(join(expandedPath, 'birth.sh'))) {\n          return 'birth.sh not found at this location';\n        }\n        return undefined;\n      },\n    });\n\n    if (p.isCancel(repoPath)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    ctx.repoPath = repoPath.replace('~', process.env.HOME || '');\n  }\n\n  p.log.message(color.dim(`Using repository: ${ctx.repoPath}`));\n\n  // Run steps\n  for (const step of STEPS) {\n    // Skip completed steps when resuming\n    if (shouldSkipStep(ctx, step.name)) {\n      p.log.message(color.dim(`Skipping ${step.name} (already completed)`));\n      continue;\n    }\n\n    try {\n      await step.fn(ctx);\n      saveState(ctx, step.name);\n    } catch (error) {\n      p.log.error(`Error in ${step.name}: ${error instanceof Error ? error.message : String(error)}`);\n      p.note(\n        `Your progress has been saved. Run ${color.cyan('npx create-samara')} to resume.`,\n        'Setup Paused'\n      );\n      process.exit(1);\n    }\n  }\n\n  p.outro(color.green('Samara is alive!'));\n}\n\n// Run\nmain().catch((error) => {\n  console.error('Unexpected error:', error);\n  process.exit(1);\n});\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport type { WizardContext } from '../types.js';\nimport {\n  isMacOS,\n  checkAllPrerequisites,\n  displayPrerequisites,\n  installMissingPrerequisites,\n  getClaudeCliInstructions,\n} from '../utils/prerequisites.js';\n\nconst BANNER = `\n${color.cyan('╭─────────────────────────────────────╮')}\n${color.cyan('│')}                                     ${color.cyan('│')}\n${color.cyan('│')}            ${color.bold('S A M A R A')}              ${color.cyan('│')}\n${color.cyan('│')}                                     ${color.cyan('│')}\n${color.cyan('│')}   ${color.dim('Give Claude a body on your Mac')}   ${color.cyan('│')}\n${color.cyan('│')}                                     ${color.cyan('│')}\n${color.cyan('╰─────────────────────────────────────╯')}\n`;\n\nexport async function welcome(ctx: WizardContext): Promise<void> {\n  console.log(BANNER);\n\n  // Check macOS\n  if (!isMacOS()) {\n    p.cancel('Samara requires macOS. This wizard only works on Mac.');\n    process.exit(1);\n  }\n\n  p.log.success('Running on macOS');\n\n  // Check prerequisites\n  p.log.step('Checking prerequisites...');\n  const results = await checkAllPrerequisites();\n  displayPrerequisites(results);\n\n  // Check for missing prerequisites\n  const missingRequired = results.filter((r) => r.required && !r.installed);\n\n  if (missingRequired.length > 0) {\n    p.log.warn('Some prerequisites are missing.');\n\n    const shouldInstall = await p.confirm({\n      message: 'Would you like to install missing dependencies?',\n      initialValue: true,\n    });\n\n    if (p.isCancel(shouldInstall)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (shouldInstall) {\n      const installResult = await installMissingPrerequisites(results);\n\n      if (installResult.needsRestart) {\n        p.log.info('Please complete the Xcode installation and run this wizard again.');\n        p.outro(color.dim('Run: npx create-samara'));\n        process.exit(0);\n      }\n\n      if (installResult.missing.length > 0) {\n        if (installResult.missing.includes('Claude Code CLI')) {\n          p.log.error('Claude Code CLI is required but not installed.');\n          console.log(getClaudeCliInstructions());\n        }\n        p.cancel('Please install missing dependencies and run this wizard again.');\n        process.exit(1);\n      }\n    } else {\n      // Check if Claude CLI is the only missing one\n      const claudeCliMissing = missingRequired.find((r) => r.name === 'Claude Code CLI');\n      if (claudeCliMissing && missingRequired.length === 1) {\n        p.log.error('Claude Code CLI is required.');\n        console.log(getClaudeCliInstructions());\n      }\n      p.cancel('Please install missing dependencies and run this wizard again.');\n      process.exit(1);\n    }\n  }\n\n  p.log.success('All prerequisites installed');\n\n  // Brief intro\n  p.note(\n    `This wizard will help you:\n\n1. Configure your Claude instance\n2. Set up the organism structure\n3. Build/download Samara.app\n4. Grant necessary permissions\n5. Start the wake/dream cycles\n\n${color.dim(\"Let's begin!\")}`,\n    'Welcome to Samara'\n  );\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { commandExists, run, brewInstall } from './shell.js';\nimport { platform } from 'os';\n\nexport interface PrerequisiteResult {\n  name: string;\n  installed: boolean;\n  version?: string;\n  required: boolean;\n  installable: boolean;\n}\n\n/**\n * Check if running on macOS\n */\nexport function isMacOS(): boolean {\n  return platform() === 'darwin';\n}\n\n/**\n * Check Xcode Command Line Tools\n */\nexport async function checkXcodeTools(): Promise<PrerequisiteResult> {\n  const result = await run('xcode-select', ['-p'], { silent: true });\n  const installed = result.exitCode === 0;\n\n  return {\n    name: 'Xcode Command Line Tools',\n    installed,\n    required: true,\n    installable: true,\n  };\n}\n\n/**\n * Install Xcode Command Line Tools\n */\nexport async function installXcodeTools(): Promise<boolean> {\n  p.log.info('Installing Xcode Command Line Tools...');\n  p.log.info('A dialog will appear. Please complete the installation and run this wizard again.');\n  await run('xcode-select', ['--install']);\n  return false; // User needs to complete installation manually\n}\n\n/**\n * Check Homebrew\n */\nexport async function checkHomebrew(): Promise<PrerequisiteResult> {\n  const installed = await commandExists('brew');\n  let version: string | undefined;\n\n  if (installed) {\n    const result = await run('brew', ['--version'], { silent: true });\n    version = result.stdout.split('\\n')[0];\n  }\n\n  return {\n    name: 'Homebrew',\n    installed,\n    version,\n    required: true,\n    installable: true,\n  };\n}\n\n/**\n * Install Homebrew\n */\nexport async function installHomebrew(): Promise<boolean> {\n  p.log.info('Installing Homebrew...');\n  const result = await run('/bin/bash', [\n    '-c',\n    '$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)',\n  ]);\n  return result.exitCode === 0;\n}\n\n/**\n * Check jq\n */\nexport async function checkJq(): Promise<PrerequisiteResult> {\n  const installed = await commandExists('jq');\n  let version: string | undefined;\n\n  if (installed) {\n    const result = await run('jq', ['--version'], { silent: true });\n    version = result.stdout.trim();\n  }\n\n  return {\n    name: 'jq',\n    installed,\n    version,\n    required: true,\n    installable: true,\n  };\n}\n\n/**\n * Install jq via Homebrew\n */\nexport async function installJq(): Promise<boolean> {\n  p.log.info('Installing jq...');\n  return brewInstall('jq');\n}\n\n/**\n * Check Claude Code CLI\n */\nexport async function checkClaudeCli(): Promise<PrerequisiteResult> {\n  const installed = await commandExists('claude');\n  let version: string | undefined;\n\n  if (installed) {\n    const result = await run('claude', ['--version'], { silent: true });\n    version = result.stdout.trim();\n  }\n\n  return {\n    name: 'Claude Code CLI',\n    installed,\n    version,\n    required: true,\n    installable: false, // Requires npm, not auto-installable\n  };\n}\n\n/**\n * Check all prerequisites\n */\nexport async function checkAllPrerequisites(): Promise<PrerequisiteResult[]> {\n  const results: PrerequisiteResult[] = [];\n\n  // Check each prerequisite\n  results.push(await checkXcodeTools());\n  results.push(await checkHomebrew());\n  results.push(await checkJq());\n  results.push(await checkClaudeCli());\n\n  return results;\n}\n\n/**\n * Display prerequisite check results\n */\nexport function displayPrerequisites(results: PrerequisiteResult[]): void {\n  for (const result of results) {\n    const status = result.installed\n      ? color.green('\\u2713')\n      : color.red('\\u2717');\n    const version = result.version ? color.dim(` (${result.version})`) : '';\n    p.log.message(`${status} ${result.name}${version}`);\n  }\n}\n\n/**\n * Attempt to install missing prerequisites\n */\nexport async function installMissingPrerequisites(\n  results: PrerequisiteResult[]\n): Promise<{ success: boolean; needsRestart: boolean; missing: string[] }> {\n  const missing: string[] = [];\n  let needsRestart = false;\n\n  for (const result of results) {\n    if (result.installed) continue;\n\n    if (!result.installable) {\n      missing.push(result.name);\n      continue;\n    }\n\n    // Try to install\n    let installed = false;\n    switch (result.name) {\n      case 'Xcode Command Line Tools':\n        installed = await installXcodeTools();\n        if (!installed) needsRestart = true;\n        break;\n      case 'Homebrew':\n        installed = await installHomebrew();\n        break;\n      case 'jq':\n        installed = await installJq();\n        break;\n    }\n\n    if (!installed && !needsRestart) {\n      missing.push(result.name);\n    }\n  }\n\n  return {\n    success: missing.length === 0 && !needsRestart,\n    needsRestart,\n    missing,\n  };\n}\n\n/**\n * Get installation instructions for Claude CLI\n */\nexport function getClaudeCliInstructions(): string {\n  return `\nTo install Claude Code CLI:\n\n  ${color.cyan('npm install -g @anthropic-ai/claude-code')}\n\nOr see: ${color.underline('https://docs.anthropic.com/claude-code')}\n`;\n}\n","import { execa, type ExecaError } from 'execa';\nimport { existsSync } from 'fs';\nimport { join } from 'path';\n\n/**\n * Check if a command exists in PATH\n */\nexport async function commandExists(command: string): Promise<boolean> {\n  try {\n    await execa('which', [command]);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Run a shell command and return output\n */\nexport async function run(\n  command: string,\n  args: string[] = [],\n  options: { cwd?: string; silent?: boolean } = {}\n): Promise<{ stdout: string; stderr: string; exitCode: number }> {\n  try {\n    const result = await execa(command, args, {\n      cwd: options.cwd,\n      stdio: options.silent ? 'pipe' : 'inherit',\n    });\n    return {\n      stdout: result.stdout || '',\n      stderr: result.stderr || '',\n      exitCode: 0,\n    };\n  } catch (error) {\n    const execaError = error as ExecaError;\n    return {\n      stdout: execaError.stdout || '',\n      stderr: execaError.stderr || '',\n      exitCode: execaError.exitCode || 1,\n    };\n  }\n}\n\n/**\n * Run the birth script\n */\nexport async function runBirth(configPath: string, repoPath: string): Promise<boolean> {\n  const birthScript = join(repoPath, 'birth.sh');\n\n  if (!existsSync(birthScript)) {\n    throw new Error(`Birth script not found at ${birthScript}`);\n  }\n\n  const result = await run('bash', [birthScript, configPath], { cwd: repoPath });\n  return result.exitCode === 0;\n}\n\n/**\n * Load a launchd agent\n */\nexport async function loadLaunchAgent(plistPath: string): Promise<boolean> {\n  const result = await run('launchctl', ['load', plistPath], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Unload a launchd agent (if needed for reload)\n */\nexport async function unloadLaunchAgent(plistPath: string): Promise<boolean> {\n  const result = await run('launchctl', ['unload', plistPath], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Check if a launchd agent is loaded\n */\nexport async function isLaunchAgentLoaded(label: string): Promise<boolean> {\n  const result = await run('launchctl', ['list'], { silent: true });\n  return result.stdout.includes(label);\n}\n\n/**\n * Open a URL or file with the default application\n */\nexport async function openUrl(url: string): Promise<boolean> {\n  const result = await run('open', [url], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Open System Preferences to a specific pane\n */\nexport async function openSystemPreferences(pane: string): Promise<boolean> {\n  return openUrl(`x-apple.systempreferences:${pane}`);\n}\n\n/**\n * Download a file using curl\n */\nexport async function downloadFile(url: string, outputPath: string): Promise<boolean> {\n  const result = await run('curl', ['-sL', '-o', outputPath, url], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Unzip a file\n */\nexport async function unzip(zipPath: string, destPath: string): Promise<boolean> {\n  const result = await run('unzip', ['-o', zipPath, '-d', destPath], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Check if a process is running\n */\nexport async function isProcessRunning(processName: string): Promise<boolean> {\n  const result = await run('pgrep', ['-f', processName], { silent: true });\n  return result.exitCode === 0;\n}\n\n/**\n * Install Homebrew package\n */\nexport async function brewInstall(packageName: string): Promise<boolean> {\n  const result = await run('brew', ['install', packageName]);\n  return result.exitCode === 0;\n}\n\n/**\n * Run xcodebuild archive\n */\nexport async function xcodeBuildArchive(\n  projectPath: string,\n  scheme: string,\n  archivePath: string\n): Promise<boolean> {\n  const result = await run('xcodebuild', [\n    '-project', projectPath,\n    '-scheme', scheme,\n    '-configuration', 'Release',\n    'archive',\n    '-archivePath', archivePath,\n  ]);\n  return result.exitCode === 0;\n}\n\n/**\n * Run xcodebuild export archive\n */\nexport async function xcodeBuildExport(\n  archivePath: string,\n  exportPath: string,\n  exportOptionsPlist: string\n): Promise<boolean> {\n  const result = await run('xcodebuild', [\n    '-exportArchive',\n    '-archivePath', archivePath,\n    '-exportPath', exportPath,\n    '-exportOptionsPlist', exportOptionsPlist,\n  ]);\n  return result.exitCode === 0;\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport type { WizardContext } from '../types.js';\nimport { isValidICloudEmail } from '../utils/validation.js';\n\nexport async function identity(ctx: WizardContext): Promise<void> {\n  p.log.step('Entity Identity');\n  p.log.message(color.dim(\"Let's set up your Claude instance's identity.\"));\n\n  const result = await p.group(\n    {\n      name: () =>\n        p.text({\n          message: \"What name should the Claude instance use?\",\n          placeholder: 'Claude',\n          defaultValue: 'Claude',\n          validate: (value) => {\n            if (!value || value.length === 0) return 'Name is required';\n            if (value.length > 50) return 'Name must be 50 characters or less';\n            return undefined;\n          },\n        }),\n\n      icloud: () =>\n        p.text({\n          message: \"iCloud email for the instance\",\n          placeholder: 'claude@icloud.com',\n          validate: (value) => {\n            if (!value || value.length === 0) return 'iCloud email is required';\n            if (!isValidICloudEmail(value)) return 'Must be an @icloud.com email address';\n            return undefined;\n          },\n        }),\n    },\n    {\n      onCancel: () => {\n        p.cancel('Setup cancelled.');\n        process.exit(0);\n      },\n    }\n  );\n\n  // Initialize config.entity if needed\n  ctx.config.entity = ctx.config.entity || {};\n  ctx.config.entity.name = result.name;\n  ctx.config.entity.icloud = result.icloud;\n\n  p.log.success(`Entity: ${color.cyan(result.name)} <${result.icloud}>`);\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport type { WizardContext } from '../types.js';\nimport { isValidEmail, isValidPhone } from '../utils/validation.js';\n\nexport async function collaborator(ctx: WizardContext): Promise<void> {\n  p.log.step('Collaborator Details');\n  p.log.message(color.dim(\"Now let's set up your information (the human collaborator).\"));\n\n  const result = await p.group(\n    {\n      name: () =>\n        p.text({\n          message: \"Your name\",\n          placeholder: 'Your name',\n          validate: (value) => {\n            if (!value || value.length === 0) return 'Name is required';\n            if (value.length > 100) return 'Name must be 100 characters or less';\n            return undefined;\n          },\n        }),\n\n      phone: () =>\n        p.text({\n          message: \"Your phone number (for iMessage)\",\n          placeholder: '+14155551234',\n          validate: (value) => {\n            if (!value || value.length === 0) return 'Phone number is required';\n            if (!isValidPhone(value)) return 'Must be E.164 format: +1234567890';\n            return undefined;\n          },\n        }),\n\n      email: () =>\n        p.text({\n          message: \"Your email\",\n          placeholder: 'you@example.com',\n          validate: (value) => {\n            if (!value || value.length === 0) return 'Email is required';\n            if (!isValidEmail(value)) return 'Must be a valid email address';\n            return undefined;\n          },\n        }),\n    },\n    {\n      onCancel: () => {\n        p.cancel('Setup cancelled.');\n        process.exit(0);\n      },\n    }\n  );\n\n  // Initialize config.collaborator if needed\n  ctx.config.collaborator = ctx.config.collaborator || {};\n  ctx.config.collaborator.name = result.name;\n  ctx.config.collaborator.phone = result.phone;\n  ctx.config.collaborator.email = result.email;\n\n  p.log.success(`Collaborator: ${color.cyan(result.name)} <${result.email}>`);\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport type { WizardContext } from '../types.js';\nimport { isValidBlueskyHandle, isValidGitHubUsername } from '../utils/validation.js';\n\nexport async function integrations(ctx: WizardContext): Promise<void> {\n  p.log.step('Optional Integrations');\n  p.log.message(color.dim('Set up social accounts for your Claude instance (optional).'));\n\n  // Ask about Bluesky\n  const setupBluesky = await p.confirm({\n    message: 'Set up Bluesky account?',\n    initialValue: false,\n  });\n\n  if (p.isCancel(setupBluesky)) {\n    p.cancel('Setup cancelled.');\n    process.exit(0);\n  }\n\n  ctx.setupBluesky = setupBluesky;\n\n  if (setupBluesky) {\n    const blueskyHandle = await p.text({\n      message: \"Claude's Bluesky handle\",\n      placeholder: '@claude.bsky.social',\n      validate: (value) => {\n        if (!value || value.length === 0) return 'Handle is required if setting up Bluesky';\n        if (!isValidBlueskyHandle(value)) return 'Must be @handle.bsky.social format';\n        return undefined;\n      },\n    });\n\n    if (p.isCancel(blueskyHandle)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    ctx.config.entity = ctx.config.entity || {};\n    ctx.config.entity.bluesky = blueskyHandle;\n    p.log.success(`Bluesky: ${color.cyan(blueskyHandle)}`);\n  }\n\n  // Ask about GitHub\n  const setupGithub = await p.confirm({\n    message: 'Set up GitHub account?',\n    initialValue: false,\n  });\n\n  if (p.isCancel(setupGithub)) {\n    p.cancel('Setup cancelled.');\n    process.exit(0);\n  }\n\n  ctx.setupGithub = setupGithub;\n\n  if (setupGithub) {\n    const githubUsername = await p.text({\n      message: \"Claude's GitHub username\",\n      placeholder: 'claude-bot',\n      validate: (value) => {\n        if (!value || value.length === 0) return 'Username is required if setting up GitHub';\n        if (!isValidGitHubUsername(value)) return 'Must be a valid GitHub username';\n        return undefined;\n      },\n    });\n\n    if (p.isCancel(githubUsername)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    ctx.config.entity = ctx.config.entity || {};\n    ctx.config.entity.github = githubUsername;\n    p.log.success(`GitHub: ${color.cyan(githubUsername)}`);\n  }\n\n  // Ask about collaborator's Bluesky (optional)\n  if (setupBluesky) {\n    const collaboratorBluesky = await p.text({\n      message: \"Your Bluesky handle (optional)\",\n      placeholder: '@you.bsky.social',\n      validate: (value) => {\n        if (!value || value.length === 0) return undefined; // Optional\n        if (!isValidBlueskyHandle(value.startsWith('@') ? value : `@${value}`)) {\n          return 'Must be @handle.bsky.social format';\n        }\n        return undefined;\n      },\n    });\n\n    if (p.isCancel(collaboratorBluesky)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (collaboratorBluesky && collaboratorBluesky.length > 0) {\n      ctx.config.collaborator = ctx.config.collaborator || {};\n      ctx.config.collaborator.bluesky = collaboratorBluesky.startsWith('@')\n        ? collaboratorBluesky\n        : `@${collaboratorBluesky}`;\n    }\n  }\n\n  if (!setupBluesky && !setupGithub) {\n    p.log.message(color.dim('No integrations selected. You can set these up later.'));\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { writeFileSync, existsSync, mkdirSync } from 'fs';\nimport { join } from 'path';\nimport { tmpdir } from 'os';\nimport type { WizardContext, SamaraConfig } from '../types.js';\nimport { runBirth } from '../utils/shell.js';\n\nexport async function birth(ctx: WizardContext): Promise<void> {\n  p.log.step('Configuration Review');\n\n  // Build the full config object\n  const config: SamaraConfig = {\n    entity: {\n      name: ctx.config.entity?.name || 'Claude',\n      icloud: ctx.config.entity?.icloud || '',\n      bluesky: ctx.config.entity?.bluesky,\n      github: ctx.config.entity?.github,\n    },\n    collaborator: {\n      name: ctx.config.collaborator?.name || '',\n      phone: ctx.config.collaborator?.phone || '',\n      email: ctx.config.collaborator?.email || '',\n      bluesky: ctx.config.collaborator?.bluesky,\n    },\n    notes: {\n      location: 'Claude Location Log',\n      scratchpad: 'Claude Scratchpad',\n    },\n    mail: {\n      account: 'iCloud',\n    },\n  };\n\n  // Display config preview\n  const configPreview = `\n${color.bold('Entity (Claude)')}\n  Name:    ${color.cyan(config.entity.name)}\n  iCloud:  ${config.entity.icloud}\n  ${config.entity.bluesky ? `Bluesky: ${config.entity.bluesky}` : ''}\n  ${config.entity.github ? `GitHub:  ${config.entity.github}` : ''}\n\n${color.bold('Collaborator (You)')}\n  Name:   ${color.cyan(config.collaborator.name)}\n  Phone:  ${config.collaborator.phone}\n  Email:  ${config.collaborator.email}\n  ${config.collaborator.bluesky ? `Bluesky: ${config.collaborator.bluesky}` : ''}\n`;\n\n  p.note(configPreview, 'Your Configuration');\n\n  const proceed = await p.confirm({\n    message: 'Proceed with this configuration?',\n    initialValue: true,\n  });\n\n  if (p.isCancel(proceed) || !proceed) {\n    p.cancel('Setup cancelled. Run npx create-samara to start over.');\n    process.exit(0);\n  }\n\n  // Write config to temp file\n  const tempDir = join(tmpdir(), 'create-samara');\n  if (!existsSync(tempDir)) {\n    mkdirSync(tempDir, { recursive: true });\n  }\n  const configPath = join(tempDir, 'config.json');\n  writeFileSync(configPath, JSON.stringify(config, null, 2));\n\n  // Run birth script\n  p.log.step('Creating organism structure...');\n\n  const spinner = p.spinner();\n  spinner.start('Running birth script...');\n\n  try {\n    const success = await runBirth(configPath, ctx.repoPath);\n\n    if (success) {\n      spinner.stop('Organism structure created');\n      p.log.success(`Created ${color.cyan(ctx.mindPath)}`);\n    } else {\n      spinner.stop('Birth script failed');\n      p.log.error('The birth script encountered an error.');\n      p.log.message(color.dim('Check the output above for details.'));\n      p.log.message(color.dim(`You can also try running manually: ${ctx.repoPath}/birth.sh ${configPath}`));\n\n      const retry = await p.confirm({\n        message: 'Would you like to retry?',\n        initialValue: true,\n      });\n\n      if (p.isCancel(retry) || !retry) {\n        p.cancel('Setup cancelled.');\n        process.exit(1);\n      }\n\n      // Retry\n      spinner.start('Retrying birth script...');\n      const retrySuccess = await runBirth(configPath, ctx.repoPath);\n\n      if (!retrySuccess) {\n        spinner.stop('Birth script failed again');\n        p.cancel('Please check the birth script manually and run this wizard again.');\n        process.exit(1);\n      }\n\n      spinner.stop('Organism structure created on retry');\n    }\n  } catch (error) {\n    spinner.stop('Birth script error');\n    p.log.error(`Error: ${error instanceof Error ? error.message : String(error)}`);\n    p.cancel('Setup failed. Please check the error and try again.');\n    process.exit(1);\n  }\n\n  // Also save config to the mind directory\n  const mindConfigPath = join(ctx.mindPath, 'config.json');\n  if (existsSync(ctx.mindPath)) {\n    writeFileSync(mindConfigPath, JSON.stringify(config, null, 2));\n    p.log.success(`Config saved to ${color.dim(mindConfigPath)}`);\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync, writeFileSync, mkdirSync } from 'fs';\nimport { join } from 'path';\nimport { tmpdir, homedir } from 'os';\nimport type { WizardContext } from '../types.js';\nimport {\n  downloadFile,\n  unzip,\n  run,\n  xcodeBuildArchive,\n  xcodeBuildExport,\n} from '../utils/shell.js';\nimport { isValidTeamId } from '../utils/validation.js';\n\nconst GITHUB_RELEASES_URL = 'https://api.github.com/repos/claudeaceae/samara-main/releases/latest';\nconst APP_PATH = '/Applications/Samara.app';\n\nexport async function app(ctx: WizardContext): Promise<void> {\n  p.log.step('Samara.app');\n\n  // Check if app already exists\n  if (existsSync(APP_PATH)) {\n    const rebuild = await p.confirm({\n      message: 'Samara.app already exists. Skip this step?',\n      initialValue: true,\n    });\n\n    if (p.isCancel(rebuild)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (rebuild) {\n      p.log.success('Using existing Samara.app');\n      return;\n    }\n  }\n\n  // Ask about Developer Account\n  const hasDeveloperAccount = await p.confirm({\n    message: 'Do you have an Apple Developer Account ($99/year)?',\n    initialValue: false,\n  });\n\n  if (p.isCancel(hasDeveloperAccount)) {\n    p.cancel('Setup cancelled.');\n    process.exit(0);\n  }\n\n  ctx.hasDeveloperAccount = hasDeveloperAccount;\n\n  if (hasDeveloperAccount) {\n    // Ask if they want to build from source\n    const buildFromSource = await p.select({\n      message: 'How would you like to get Samara.app?',\n      options: [\n        {\n          value: 'download',\n          label: 'Download pre-built (faster)',\n          hint: 'Uses existing Team ID, you can rebuild later',\n        },\n        {\n          value: 'build',\n          label: 'Build from source',\n          hint: 'Uses your Team ID, full customization',\n        },\n      ],\n    });\n\n    if (p.isCancel(buildFromSource)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    ctx.buildFromSource = buildFromSource === 'build';\n\n    if (ctx.buildFromSource) {\n      await buildFromSourceFlow(ctx);\n      return;\n    }\n  } else {\n    p.note(\n      `Without a Developer Account, Full Disk Access won't persist if you rebuild the app later.\n\nThis is fine for getting started - you can always get a Developer Account later.`,\n      'Note'\n    );\n  }\n\n  // Download pre-built app\n  await downloadPrebuiltFlow(ctx);\n}\n\nasync function downloadPrebuiltFlow(ctx: WizardContext): Promise<void> {\n  const spinner = p.spinner();\n  spinner.start('Fetching latest release...');\n\n  try {\n    // Get latest release info\n    const tempDir = join(tmpdir(), 'create-samara');\n    mkdirSync(tempDir, { recursive: true });\n    const releaseInfoPath = join(tempDir, 'release.json');\n\n    await downloadFile(GITHUB_RELEASES_URL, releaseInfoPath);\n\n    // For now, we'll use a direct download URL\n    // In production, parse the release JSON to get the asset URL\n    const downloadUrl = 'https://github.com/claudeaceae/samara-main/releases/latest/download/Samara.app.zip';\n    const zipPath = join(tempDir, 'Samara.app.zip');\n\n    spinner.message('Downloading Samara.app...');\n    const downloaded = await downloadFile(downloadUrl, zipPath);\n\n    if (!downloaded || !existsSync(zipPath)) {\n      spinner.stop('Download failed');\n      p.log.warn('Could not download pre-built app. Falling back to Xcode instructions.');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    spinner.message('Installing Samara.app...');\n    const unzipped = await unzip(zipPath, '/Applications');\n\n    if (!unzipped || !existsSync(APP_PATH)) {\n      spinner.stop('Installation failed');\n      p.log.warn('Could not install app. Falling back to Xcode instructions.');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    spinner.stop('Samara.app installed');\n    p.log.success(`Installed to ${color.cyan(APP_PATH)}`);\n  } catch (error) {\n    spinner.stop('Error');\n    p.log.warn(`Download failed: ${error instanceof Error ? error.message : String(error)}`);\n    p.log.message(color.dim('Falling back to Xcode instructions...'));\n    await manualXcodeFlow(ctx);\n  }\n}\n\nasync function buildFromSourceFlow(ctx: WizardContext): Promise<void> {\n  // Get Team ID\n  const teamId = await p.text({\n    message: 'Enter your Apple Team ID',\n    placeholder: 'XXXXXXXXXX',\n    validate: (value) => {\n      if (!value || value.length === 0) return 'Team ID is required';\n      if (!isValidTeamId(value)) return 'Team ID must be 10 alphanumeric characters';\n      return undefined;\n    },\n  });\n\n  if (p.isCancel(teamId)) {\n    p.cancel('Setup cancelled.');\n    process.exit(0);\n  }\n\n  ctx.teamId = teamId;\n\n  // Generate ExportOptions.plist\n  const exportOptionsPlist = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n    <key>method</key>\n    <string>developer-id</string>\n    <key>teamID</key>\n    <string>${teamId}</string>\n    <key>signingStyle</key>\n    <string>automatic</string>\n</dict>\n</plist>`;\n\n  const tempDir = join(tmpdir(), 'create-samara');\n  mkdirSync(tempDir, { recursive: true });\n  const exportOptionsPath = join(tempDir, 'ExportOptions.plist');\n  writeFileSync(exportOptionsPath, exportOptionsPlist);\n\n  const spinner = p.spinner();\n  spinner.start('Building Samara.app (this may take a few minutes)...');\n\n  try {\n    const projectPath = join(ctx.repoPath, 'Samara', 'Samara.xcodeproj');\n    const archivePath = join(tempDir, 'Samara.xcarchive');\n    const exportPath = join(tempDir, 'SamaraExport');\n\n    // Archive\n    spinner.message('Archiving...');\n    const archiveSuccess = await xcodeBuildArchive(projectPath, 'Samara', archivePath);\n\n    if (!archiveSuccess) {\n      spinner.stop('Archive failed');\n      p.log.warn('xcodebuild archive failed. Falling back to manual instructions.');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    // Export\n    spinner.message('Exporting...');\n    const exportSuccess = await xcodeBuildExport(archivePath, exportPath, exportOptionsPath);\n\n    if (!exportSuccess) {\n      spinner.stop('Export failed');\n      p.log.warn('xcodebuild export failed. Falling back to manual instructions.');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    // Copy to Applications\n    spinner.message('Installing...');\n    const exportedApp = join(exportPath, 'Samara.app');\n\n    if (!existsSync(exportedApp)) {\n      spinner.stop('App not found after export');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    // Remove existing app if present\n    if (existsSync(APP_PATH)) {\n      await run('rm', ['-rf', APP_PATH], { silent: true });\n    }\n\n    await run('cp', ['-R', exportedApp, APP_PATH], { silent: true });\n\n    if (!existsSync(APP_PATH)) {\n      spinner.stop('Installation failed');\n      await manualXcodeFlow(ctx);\n      return;\n    }\n\n    spinner.stop('Samara.app built and installed');\n    p.log.success(`Built with Team ID: ${color.cyan(teamId)}`);\n    p.log.success(`Installed to ${color.cyan(APP_PATH)}`);\n  } catch (error) {\n    spinner.stop('Build error');\n    p.log.error(`Error: ${error instanceof Error ? error.message : String(error)}`);\n    p.log.message(color.dim('Falling back to manual instructions...'));\n    await manualXcodeFlow(ctx);\n  }\n}\n\nasync function manualXcodeFlow(ctx: WizardContext): Promise<void> {\n  p.note(\n    `${color.bold('Manual Xcode Build Required')}\n\n1. Opening Xcode project...\n2. In Xcode:\n   - Select your Team in Signing & Capabilities\n   - Product > Archive\n   - Distribute App > Developer ID\n   - Export to a location\n   - Move Samara.app to /Applications/\n\n${color.dim('Press Enter when done.')}`,\n    'Xcode Instructions'\n  );\n\n  // Open Xcode project\n  const projectPath = join(ctx.repoPath, 'Samara', 'Samara.xcodeproj');\n  await run('open', [projectPath], { silent: true });\n\n  await p.text({\n    message: 'Press Enter when Samara.app is in /Applications/',\n    placeholder: '',\n    validate: () => {\n      if (!existsSync(APP_PATH)) {\n        return 'Samara.app not found in /Applications/. Please complete the Xcode build first.';\n      }\n      return undefined;\n    },\n  });\n\n  p.log.success('Samara.app found');\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync, accessSync, constants } from 'fs';\nimport { homedir } from 'os';\nimport { join } from 'path';\nimport type { WizardContext } from '../types.js';\nimport { openSystemPreferences } from '../utils/shell.js';\n\nconst CHAT_DB_PATH = join(homedir(), 'Library/Messages/chat.db');\n\nexport async function permissions(ctx: WizardContext): Promise<void> {\n  p.log.step('Permissions');\n  p.log.message(color.dim('Samara needs Full Disk Access to read messages.'));\n\n  // Check if FDA is already granted by trying to access chat.db\n  if (await hasFdaAccess()) {\n    p.log.success('Full Disk Access already granted');\n    return;\n  }\n\n  p.note(\n    `${color.bold('Grant Full Disk Access')}\n\n1. Opening System Settings...\n2. Click the ${color.cyan('+')} button\n3. Navigate to ${color.cyan('/Applications/Samara.app')}\n4. Add it to the list\n5. Enable the toggle\n\n${color.dim('Press Enter when done.')}`,\n    'Full Disk Access'\n  );\n\n  // Open System Preferences to FDA pane\n  await openSystemPreferences('com.apple.preference.security?Privacy_AllFiles');\n\n  // Wait for user to grant access\n  let attempts = 0;\n  const maxAttempts = 3;\n\n  while (attempts < maxAttempts) {\n    const proceed = await p.text({\n      message: 'Press Enter after granting Full Disk Access',\n      placeholder: '',\n    });\n\n    if (p.isCancel(proceed)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (await hasFdaAccess()) {\n      p.log.success('Full Disk Access granted');\n      return;\n    }\n\n    attempts++;\n    if (attempts < maxAttempts) {\n      p.log.warn('Full Disk Access not detected. Please try again.');\n      p.log.message(color.dim(`Make sure Samara.app is added to the list and the toggle is enabled.`));\n    }\n  }\n\n  // If we get here, FDA wasn't granted after multiple attempts\n  const skipFda = await p.confirm({\n    message: 'Continue without Full Disk Access? (iMessage reading will not work)',\n    initialValue: false,\n  });\n\n  if (p.isCancel(skipFda)) {\n    p.cancel('Setup cancelled.');\n    process.exit(0);\n  }\n\n  if (!skipFda) {\n    p.note(\n      `${color.bold('Troubleshooting Full Disk Access')}\n\n1. Make sure you're adding the correct app:\n   ${color.cyan('/Applications/Samara.app')}\n\n2. The app must be in /Applications, not elsewhere\n\n3. The toggle must be ${color.green('ON')} (green)\n\n4. You may need to restart Samara.app after granting\n\n5. Try removing and re-adding the app if it doesn't work`,\n      'Help'\n    );\n\n    p.cancel('Please grant Full Disk Access and run this wizard again.');\n    process.exit(1);\n  }\n\n  p.log.warn('Continuing without Full Disk Access. iMessage features will not work.');\n}\n\n/**\n * Check if Full Disk Access is granted by trying to read chat.db\n */\nasync function hasFdaAccess(): Promise<boolean> {\n  try {\n    // Check if chat.db exists and is readable\n    if (!existsSync(CHAT_DB_PATH)) {\n      // chat.db doesn't exist, which is fine - FDA might still be granted\n      // This can happen on new accounts or if Messages hasn't been used\n      return true;\n    }\n\n    // Try to access the file\n    accessSync(CHAT_DB_PATH, constants.R_OK);\n    return true;\n  } catch {\n    // Access denied - FDA not granted\n    return false;\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync, readdirSync, copyFileSync } from 'fs';\nimport { join, basename } from 'path';\nimport { homedir } from 'os';\nimport type { WizardContext } from '../types.js';\nimport { loadLaunchAgent, isLaunchAgentLoaded } from '../utils/shell.js';\n\nconst LAUNCH_AGENTS_DIR = join(homedir(), 'Library/LaunchAgents');\n\nconst REQUIRED_PLISTS = [\n  'com.claude.wake-adaptive.plist',\n  'com.claude.dream.plist',\n];\n\nexport async function launchd(ctx: WizardContext): Promise<void> {\n  p.log.step('Wake/Dream Cycles');\n  p.log.message(color.dim('Installing scheduled tasks for autonomous operation.'));\n\n  const spinner = p.spinner();\n  spinner.start('Installing launchd services...');\n\n  const sourcePlistDir = join(ctx.mindPath, 'launchd');\n  const results: { name: string; success: boolean; error?: string }[] = [];\n\n  // Check if source directory exists\n  if (!existsSync(sourcePlistDir)) {\n    spinner.stop('Source directory not found');\n    p.log.warn(`Launchd plists not found at ${sourcePlistDir}`);\n    p.log.message(color.dim('You may need to run birth.sh first or check the installation.'));\n    return;\n  }\n\n  // Get all plist files\n  const plistFiles = readdirSync(sourcePlistDir).filter((f) => f.endsWith('.plist'));\n\n  if (plistFiles.length === 0) {\n    spinner.stop('No plist files found');\n    p.log.warn('No launchd plist files found to install.');\n    return;\n  }\n\n  // Process each plist\n  for (const plistFile of plistFiles) {\n    const sourcePath = join(sourcePlistDir, plistFile);\n    const destPath = join(LAUNCH_AGENTS_DIR, plistFile);\n    const label = basename(plistFile, '.plist');\n\n    try {\n      // Check if already loaded\n      const alreadyLoaded = await isLaunchAgentLoaded(label);\n      if (alreadyLoaded) {\n        results.push({ name: label, success: true });\n        continue;\n      }\n\n      // Copy to LaunchAgents\n      copyFileSync(sourcePath, destPath);\n\n      // Load the agent\n      const loaded = await loadLaunchAgent(destPath);\n      results.push({\n        name: label,\n        success: loaded,\n        error: loaded ? undefined : 'Failed to load',\n      });\n    } catch (error) {\n      results.push({\n        name: label,\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      });\n    }\n  }\n\n  spinner.stop('Services processed');\n\n  // Display results\n  const successful = results.filter((r) => r.success);\n  const failed = results.filter((r) => !r.success);\n\n  for (const result of successful) {\n    p.log.success(`${color.green('\\u2713')} ${result.name}`);\n  }\n\n  for (const result of failed) {\n    p.log.error(`${color.red('\\u2717')} ${result.name}: ${result.error}`);\n  }\n\n  if (failed.length > 0) {\n    p.note(\n      `Some services failed to load. You can try loading them manually:\n\n${failed.map((f) => `  launchctl load ~/Library/LaunchAgents/${f.name}.plist`).join('\\n')}`,\n      'Manual Loading'\n    );\n\n    const continueAnyway = await p.confirm({\n      message: 'Continue with setup?',\n      initialValue: true,\n    });\n\n    if (p.isCancel(continueAnyway) || !continueAnyway) {\n      p.cancel('Setup cancelled.');\n      process.exit(1);\n    }\n  } else {\n    p.log.success(`All ${successful.length} services installed`);\n\n    // Show schedule\n    p.note(\n      `${color.bold('Adaptive Wake System')}\n  Every 15 min - Scheduler checks for wake conditions\n  Base times   - ~9 AM, ~2 PM, ~8 PM (full wakes)\n  Adaptive     - Calendar events, priority items\n  3:00 AM      - Dream cycle (memory consolidation)`,\n      'Autonomy Cycles'\n    );\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync, writeFileSync, mkdirSync } from 'fs';\nimport { join } from 'path';\nimport type { WizardContext } from '../types.js';\n\nexport async function credentials(ctx: WizardContext): Promise<void> {\n  // Skip if no integrations were selected\n  if (!ctx.setupBluesky && !ctx.setupGithub) {\n    p.log.message(color.dim('No credentials needed (no integrations selected).'));\n    return;\n  }\n\n  p.log.step('Credentials');\n  p.log.message(color.dim('Set up API keys for your integrations.'));\n\n  const credentialsDir = join(ctx.mindPath, 'credentials');\n\n  // Ensure credentials directory exists\n  if (!existsSync(credentialsDir)) {\n    mkdirSync(credentialsDir, { recursive: true });\n  }\n\n  // Bluesky credentials\n  if (ctx.setupBluesky) {\n    p.note(\n      `${color.bold('Bluesky App Password')}\n\n1. Go to ${color.cyan('https://bsky.app/settings/app-passwords')}\n2. Create a new app password\n3. Copy the password (looks like: xxxx-xxxx-xxxx-xxxx)`,\n      'Bluesky Setup'\n    );\n\n    const blueskyPassword = await p.password({\n      message: 'Enter Bluesky app password (or leave empty to skip)',\n    });\n\n    if (p.isCancel(blueskyPassword)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (blueskyPassword && blueskyPassword.length > 0) {\n      const blueskyHandle = ctx.config.entity?.bluesky || '';\n      const blueskyCredentials = {\n        identifier: blueskyHandle.replace('@', ''),\n        password: blueskyPassword,\n      };\n\n      const blueskyPath = join(credentialsDir, 'bluesky.json');\n      writeFileSync(blueskyPath, JSON.stringify(blueskyCredentials, null, 2), { mode: 0o600 });\n      p.log.success(`Bluesky credentials saved to ${color.dim(blueskyPath)}`);\n    } else {\n      p.log.message(color.dim('Skipped Bluesky credentials. You can add them later.'));\n    }\n  }\n\n  // GitHub credentials\n  if (ctx.setupGithub) {\n    p.note(\n      `${color.bold('GitHub Personal Access Token')}\n\n1. Go to ${color.cyan('https://github.com/settings/tokens')}\n2. Generate new token (classic)\n3. Select scopes: repo, user (at minimum)\n4. Copy the token`,\n      'GitHub Setup'\n    );\n\n    const githubToken = await p.password({\n      message: 'Enter GitHub personal access token (or leave empty to skip)',\n    });\n\n    if (p.isCancel(githubToken)) {\n      p.cancel('Setup cancelled.');\n      process.exit(0);\n    }\n\n    if (githubToken && githubToken.length > 0) {\n      const githubPath = join(credentialsDir, 'github.txt');\n      writeFileSync(githubPath, githubToken, { mode: 0o600 });\n      p.log.success(`GitHub token saved to ${color.dim(githubPath)}`);\n    } else {\n      p.log.message(color.dim('Skipped GitHub credentials. You can add them later.'));\n    }\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { existsSync } from 'fs';\nimport type { WizardContext } from '../types.js';\nimport { run, isProcessRunning } from '../utils/shell.js';\n\nconst APP_PATH = '/Applications/Samara.app';\n\nexport async function launch(ctx: WizardContext): Promise<void> {\n  p.log.step('Launch');\n\n  if (!existsSync(APP_PATH)) {\n    p.log.warn('Samara.app not found in /Applications/');\n    p.log.message(color.dim('Skipping launch step. Please install the app manually.'));\n    return;\n  }\n\n  // Check if already running\n  const alreadyRunning = await isProcessRunning('Samara');\n  if (alreadyRunning) {\n    p.log.success('Samara is already running');\n    return;\n  }\n\n  const spinner = p.spinner();\n  spinner.start('Launching Samara...');\n\n  try {\n    // Launch the app\n    await run('open', [APP_PATH], { silent: true });\n\n    // Wait a moment for it to start\n    await new Promise((resolve) => setTimeout(resolve, 2000));\n\n    // Verify it's running\n    const running = await isProcessRunning('Samara');\n\n    if (running) {\n      spinner.stop('Samara is running');\n      p.log.success('Samara.app launched successfully');\n    } else {\n      spinner.stop('Launch may have failed');\n      p.log.warn('Samara may not have started correctly.');\n\n      const retry = await p.confirm({\n        message: 'Try launching again?',\n        initialValue: true,\n      });\n\n      if (p.isCancel(retry)) {\n        p.cancel('Setup cancelled.');\n        process.exit(0);\n      }\n\n      if (retry) {\n        spinner.start('Retrying launch...');\n        await run('open', [APP_PATH], { silent: true });\n        await new Promise((resolve) => setTimeout(resolve, 3000));\n\n        const runningRetry = await isProcessRunning('Samara');\n        if (runningRetry) {\n          spinner.stop('Samara is running');\n          p.log.success('Samara.app launched on retry');\n        } else {\n          spinner.stop('Launch failed');\n          p.log.warn('Could not verify Samara is running. You may need to launch it manually.');\n        }\n      }\n    }\n  } catch (error) {\n    spinner.stop('Launch error');\n    p.log.error(`Error: ${error instanceof Error ? error.message : String(error)}`);\n    p.log.message(color.dim('You can launch Samara manually: open /Applications/Samara.app'));\n  }\n}\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { join } from 'path';\nimport type { WizardContext } from '../types.js';\nimport { clearState } from '../context.js';\n\nexport async function summary(ctx: WizardContext): Promise<void> {\n  // Clear saved state - setup is complete\n  clearState();\n\n  const entityName = ctx.config.entity?.name || 'Claude';\n  const collaboratorName = ctx.config.collaborator?.name || 'You';\n  const collaboratorPhone = ctx.config.collaborator?.phone || '';\n  const logsPath = join(ctx.mindPath, 'logs');\n  const configPath = join(ctx.mindPath, 'config.json');\n  const samaraLogPath = join(logsPath, 'samara.log');\n\n  const nextSteps = `\n${color.bold('Setup Complete!')}\n\n${color.cyan(entityName)} is now running on this Mac.\n\n${color.bold('Test it out:')}\n  Send a message from your phone to ${entityName}\n  ${collaboratorPhone ? `(from ${collaboratorPhone})` : ''}\n\n${color.bold('Wake Schedule:')}\n  9:00 AM  - Morning wake\n  2:00 PM  - Afternoon wake\n  8:00 PM  - Evening wake\n  3:00 AM  - Dream cycle\n\n${color.bold('Useful commands:')}\n  ${color.cyan('claude')}              - Start a conversation\n  ${color.cyan('/status')}             - Check system health\n  ${color.cyan('/sync')}               - Check for drift\n\n${color.bold('Locations:')}\n  Memory:  ${color.dim(ctx.mindPath)}\n  Logs:    ${color.dim(logsPath)}\n  Config:  ${color.dim(configPath)}\n\n${color.bold('Learn more:')}\n  ${color.underline('https://github.com/claudeaceae/samara-main')}\n  ${color.underline('https://claude.organelle.co')}\n`;\n\n  console.log(nextSteps);\n\n  p.note(\n    `${color.bold(`Hello, ${collaboratorName}!`)}\n\nI'm ${entityName}. Send me a message whenever you're ready.\n\nIf you don't hear back, check if I'm running:\n  ${color.cyan('pgrep -fl Samara')}\n\nOr check the logs:\n  ${color.cyan(`tail -f ${samaraLogPath}`)}`,\n    `From ${entityName}`\n  );\n}\n"],"mappings":"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","names":["p","color","existsSync","join","p","color","color","p","color","color","p","color","color","p","color","color","p","color","existsSync","join","color","join","existsSync","spinner","p","color","existsSync","writeFileSync","mkdirSync","join","tmpdir","existsSync","spinner","join","tmpdir","mkdirSync","color","writeFileSync","p","color","existsSync","homedir","join","join","homedir","color","existsSync","p","color","existsSync","join","homedir","join","homedir","color","spinner","join","existsSync","p","color","existsSync","writeFileSync","mkdirSync","join","p","color","existsSync","APP_PATH","existsSync","color","spinner","p","color","join","join","color","existsSync","join","color"]}