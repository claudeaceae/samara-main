#!/bin/bash
# Update terroir data for the website
# Runs hourly via launchd

set -e

MIND_PATH="${SAMARA_MIND_PATH:-${MIND_PATH:-$HOME/.claude-mind}}"
SCRIPT_DIR="$MIND_PATH/system/bin"
OUTPUT_FILE="$HOME/www/public/terroir.json"

# Ensure output directory exists
mkdir -p "$(dirname "$OUTPUT_FILE")"

# Generate terroir data
"$SCRIPT_DIR/terroir" > "$OUTPUT_FILE"

# Log success
echo "[$(date)] Updated terroir data" >> "$MIND_PATH/system/logs/terroir.log"
